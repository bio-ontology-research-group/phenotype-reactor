
<div class="content mt-2">
<div class="card mb-4 wow fadeIn">
    <div class="card-body justify-content-between">
        <app-search-bar (selectedTerm)="onTermSelect($event)" [valueset] = "valueset"></app-search-bar>
    </div>
</div>
<div class="card mb-4 wow fadeIn" *ngIf="!(iri && valueset)">
    <div class="card-body justify-content-between p-4">
        <span class="card-title">About the Phenotype Reactor project</span>
        <p class="mt-3">The Phenotype Reactor is a platform that aggregate phenotype connections with different biomedical concepts and provides ability to 
        compute phentypic similarity between these concepts. It also provides SPARQL endpoint and a query editor for querying the phenotypes 
        relations knowledge base. The aggregated knowledge base covers diverse categories of biomedical concepts including but not limited 
        to phentype relations with genes, genotype, disease, drug, pathogens and metabolites. <br />
        We have integrated phenotype relations from various sources including research studies and community resources such as 
        <a (click)="openInNewTab('https://hpo.jax.org/app/download/annotation')" class="text-primary">HPO phenotype annontations</a>.</p>
    </div>
</div>
<div class="card mb-4 wow fadeIn" *ngIf="iri && valueset">
    <div class="card-body justify-content-between">
        <span>
            <span class="card-title" *ngIf="entity">{{entity.label[0]}}</span> 
            <span class="card-title" *ngIf="!entity">Name</span>  
        </span>
        <small class="text-muted ml-2" *ngIf="entity?.oboid">{{entity.oboid}}</small>
        <h6 class="card-subtitle mt-3">
            <span *ngIf="entity">{{entity.definition ? entity.definition[0]: ''}}</span> 
            <span *ngIf="!entity">Definition</span>  
        </h6>    
        <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs" (navChange)="onNavChange($event)">
             <li [ngbNavItem]="typeIdx + 1" *ngFor="let type of types; let typeIdx = index">
                <a ngbNavLink>{{type.replace(BASE_PREFIX, '')}} Association</a>
                <ng-template ngbNavContent>
                    <app-list-association [associations]="typeToAssoicationMap[type]" [entities]="entities" [valueset]="valueset"></app-list-association>
                </ng-template>
            </li>
            <li [ngbNavItem]="types.length + 1">
                <a ngbNavLink>Similar Entities</a>
                <ng-template ngbNavContent>
                <div class="row"> 
                    <div class="col-1 p-2 pt-3 ml-3">
                        <label><strong>Filter By:</strong></label>
                    </div>
                    <div class="col-2 p-2">
                        <select class="browser-default custom-select default ml-3" color="default" (change)="onTypeSelect($event)">
                            <option value="">Select Type</option>
                            <option *ngFor="let type of TYPES" value="{{type.uri}}" [selected]='typeFilter == type.uri'>{{type.name}}</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <table class="table table-striped">
                    <thead color="default">
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Type</th>
                        <th scope="col">Score</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let similarConcept of similarConceptsPage; let assocIndex = index">
                        <td class="w-50">
                            <a (click)="openInNewTab(similarConcept.concept.value)" class="text-muted">
                                <h6 *ngIf="this.similarEntities[similarConcept.concept.value]">{{this.similarEntities[similarConcept.concept.value]['label'][0]}}</h6><small class="text-muted">{{similarConcept.concept.value}}</small>
                            </a>
                        </td>
                        <td>{{similarConcept.type ? similarConcept.type.value.split('/')[similarConcept.type.value.split('/').length - 1] : ''}}</td>
                        <td>{{similarConcept.val?.value}}<td>
                    </tr>
                    </tbody>
                    </table>
                    <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [pageSize]="pageSize">
                    </ngb-pagination>

                    <select class="custom-select" style="width: auto" [(ngModel)]="pageSize">
                        <option [ngValue]="10">10 items per page</option>
                        <option [ngValue]="20">20 items per page</option>
                        <option [ngValue]="50">50 items per page</option>
                    </select>
                </div>
                </ng-template>
            </li>
        </ul>
        <div [ngbNavOutlet]="nav" class="mt-2"></div>
    </div>
</div>
</div>
<div class="card mb-4 wow fadeIn" *ngIf="iri && valueset">
    <div class="card-body justify-content-between">
    <app-sparql-form [query]="query"></app-sparql-form>
</div>
</div>